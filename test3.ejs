<%- include('../partials/header.ejs') %>
<head>
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png" />
  <!-- Material Design Iconic Font-V2.2.0 -->
  <link rel="stylesheet" href="/css/material-design-iconic-font.min.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/css/font-awesome.min.css" />
  <!-- Font Awesome Stars-->
  <link rel="stylesheet" href="/css/fontawesome-stars.css" />
  <!-- Meanmenu CSS -->
  <link rel="stylesheet" href="/css/meanmenu.css" />
  <!-- owl carousel CSS -->
  <link rel="stylesheet" href="/css/owl.carousel.min.css" />
  <!-- Slick Carousel CSS -->
  <link rel="stylesheet" href="/css/slick.css" />
  <!-- Animate CSS -->
  <link rel="stylesheet" href="/css/animate.css" />
  <!-- Jquery-ui CSS -->
  <link rel="stylesheet" href="/css/jquery-ui.min.css" />
  <!-- Venobox CSS -->
  <link rel="stylesheet" href="/css/venobox.css" />
  <!-- Nice Select CSS -->
  <link rel="stylesheet" href="/css/nice-select.css" />
  <!-- Magnific Popup CSS -->
  <link rel="stylesheet" href="/css/magnific-popup.css" />
  <!-- Bootstrap V4.1.3 Fremwork CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" />
  <!-- Helper CSS -->
  <link rel="stylesheet" href="/css/helper.css" />
  <!-- Main Style CSS -->
  <link rel="stylesheet" href="style.css" />
  <!-- Responsive CSS -->
  <link rel="stylesheet" href="/css/responsive.css" />
</head>
<style>
  /* Enhanced Product Styling */
  /* Main Layout */
  .single-product-area {
    padding: 40px 0;
  }

  /* Breadcrumb */
  .product-breadcrumb {
    margin-bottom: 30px;
  }
  
  .product-breadcrumb ol {
    display: flex;
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: 14px;
  }
  
  .product-breadcrumb li + li:before {
    content: "â€º";
    padding: 0 8px;
    color: #777;
  }

  /* Main Product Image */
  .product-details-left {
    position: relative;
    margin-bottom: 30px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
  }

  .product-details-images {
    position: relative;
    overflow: hidden;
    border-radius: 10px;
  }

  .lg-image {
    overflow: hidden;
    position: relative;
    height: 450px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f9f9f9;
  }

  .lg-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    transition: all 0.5s ease;
  }

  .lg-image:hover img {
    transform: scale(1.05);
  }

  /* Image Zoom Feature */
  .img-zoom-container {
    position: relative;
    height: 100%;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .img-zoom-lens {
    position: absolute;
    border: 1px solid #d4d4d4;
    width: 120px;
    height: 120px;
    background-repeat: no-repeat;
    cursor: crosshair;
    opacity: 0;
    pointer-events: none;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    z-index: 10;
  }

  .img-zoom-result {
    position: absolute;
    top: 0;
    right: -300px;
    width: 300px;
    height: 300px;
    border: 2px solid #d4d4d4;
    z-index: 999;
    background-color: white;
    background-repeat: no-repeat;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
    border-radius: 10px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    pointer-events: none;
  }
  
  .lg-image:hover .img-zoom-lens {
    opacity: 0.3;
  }
  
  .lg-image:hover .img-zoom-result {
    opacity: 1;
    visibility: visible;
    right: -310px;
  }

  /* Image Overlay for Zoom Hint */
  .zoom-hint {
    position: absolute;
    right: 15px;
    bottom: 15px;
    color: #fff;
    background: rgba(0, 0, 0, 0.5);
    padding: 6px 10px;
    border-radius: 20px;
    font-size: 12px;
    opacity: 0.7;
    transition: opacity 0.3s;
  }

  .lg-image:hover .zoom-hint {
    opacity: 1;
  }

  /* Image Badges */
  .product-badge {
    position: absolute;
    top: 15px;
    left: 15px;
    z-index: 10;
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .badge-new, .badge-sale, .badge-featured {
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .badge-new {
    background-color: #00c853;
    color: white;
  }

  .badge-sale {
    background-color: #ff3d00;
    color: white;
  }

  .badge-featured {
    background-color: #2962ff;
    color: white;
  }

  /* Thumbnails Styling */
  .product-details-thumbs {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    overflow-x: auto;
    padding: 5px 0;
    scroll-behavior: smooth;
    scrollbar-width: thin;
  }

  .product-details-thumbs::-webkit-scrollbar {
    height: 6px;
  }

  .product-details-thumbs::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }

  .product-details-thumbs::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 10px;
  }

  .sm-image {
    flex: 0 0 80px;
    height: 80px;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
  }

  .sm-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .sm-image:hover, .sm-image.active {
    border-color: #ff6a00;
    transform: translateY(-3px);
  }

  .sm-image:hover img {
    transform: scale(1.1);
  }

  /* Product Info Styling */
  .product-details-view-content {
    padding: 0 20px;
  }

  .product-info h2 {
    font-size: 28px;
    font-weight: 600;
    margin-bottom: 15px;
    color: #333;
  }

  .product-details-ref {
    display: inline-block;
    font-size: 14px;
    color: #777;
    margin-bottom: 15px;
  }

  /* Rating Stars */
  .rating-box {
    margin-bottom: 20px;
  }

  .rating {
    display: flex;
    gap: 5px;
    align-items: center;
  }

  .rating li {
    color: #ffb400;
  }

  .rating .no-star {
    color: #ddd;
  }

  .rating-with-review-item {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
  }

  .review-item a {
    color: #555;
    text-decoration: none;
    font-size: 14px;
    transition: color 0.3s;
  }

  .review-item a:hover {
    color: #ff6a00;
  }

  /* Price Styling */
  .price-box {
    margin-bottom: 25px;
    display: flex;
    align-items: baseline;
    gap: 10px;
  }

  .new-price {
    font-size: 24px;
    font-weight: 700;
    color: #ff6a00;
  }

  .old-price {
    font-size: 18px;
    font-weight: 400;
    color: #999;
    text-decoration: line-through;
  }

  .discount-percentage {
    background-color: #ff6a00;
    color: white;
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 600;
  }

  /* Product Short Description */
  .product-desc {
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
  }

  .product-desc p {
    line-height: 1.6;
    color: #555;
  }

  /* Quantity Selector */
  .single-add-to-cart {
    margin-bottom: 25px;
  }

  .cart-quantity {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
  }

  .quantity {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .quantity label {
    font-weight: 600;
    color: #555;
  }

  .cart-plus-minus {
    position: relative;
    width: 120px;
    height: 45px;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow: hidden;
    display: flex;
    align-items: center;
  }

  .cart-plus-minus-box {
    width: 100%;
    height: 100%;
    border: none;
    text-align: center;
    font-size: 16px;
    background: transparent;
  }

  .qtybutton {
    position: absolute;
    width: 30px;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    background: #f5f5f5;
    transition: all 0.3s ease;
  }

  .dec.qtybutton {
    left: 0;
    border-right: 1px solid #ddd;
  }

  .inc.qtybutton {
    right: 0;
    border-left: 1px solid #ddd;
  }

  .qtybutton:hover {
    background: #eee;
  }

  /* Add to Cart Button */
  .add-to-cart {
    padding: 12px 32px;
    background: #ff6a00;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .add-to-cart:hover {
    background: #e55f00;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(229, 95, 0, 0.25);
  }

  .add-to-cart:active {
    transform: translateY(0);
    box-shadow: none;
  }

  /* Social Sharing */
  .product-social-sharing {
    margin-top: 25px;
    padding-top: 20px;
    border-top: 1px solid #eee;
  }

  .product-social-sharing ul {
    display: flex;
    gap: 10px;
    list-style: none;
    padding: 0;
  }

  .product-social-sharing li a {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 8px 15px;
    border-radius: 4px;
    color: white;
    font-size: 14px;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .facebook a {
    background-color: #3b5998;
  }

  .twitter a {
    background-color: #1da1f2;
  }

  .google-plus a {
    background-color: #dd4b39;
  }

  .instagram a {
    background-color: #c32aa3;
  }

  .product-social-sharing a:hover {
    opacity: 0.9;
    transform: translateY(-2px);
  }

  /* Product Description Tabs */
  .li-product-tab {
    border-bottom: 1px solid #eee;
    margin-bottom: 30px;
  }

  .li-product-menu {
    display: flex;
    list-style: none;
    padding: 0;
    gap: 30px;
    margin: 0;
  }

  .li-product-menu li a {
    display: block;
    padding: 15px 5px;
    color: #777;
    font-size: 16px;
    font-weight: 600;
    text-decoration: none;
    position: relative;
    transition: all 0.3s ease;
  }

  .li-product-menu li a.active,
  .li-product-menu li a:hover {
    color: #ff6a00;
  }

  .li-product-menu li a.active::after {
    content: "";
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 100%;
    height: 3px;
    background-color: #ff6a00;
  }

  /* Tab Content */
  .tab-content {
    padding: 30px 0;
  }

  .tab-pane {
    display: none;
  }

  .tab-pane.active {
    display: block;
    animation: fadeIn 0.5s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .product-description {
    line-height: 1.8;
    color: #555;
  }

  /* Product Details */
  .product-details-manufacturer {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .product-details-manufacturer img {
    max-width: 150px;
    margin-bottom: 20px;
  }

  .product-details-manufacturer p {
    display: flex;
    gap: 10px;
    align-items: baseline;
  }

  .product-details-manufacturer span {
    font-weight: 600;
    min-width: 100px;
    color: #555;
  }

  /* Reviews Section */
  .comment-review {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
  }

  .comment-author-infos {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
  }

  .comment-details {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
  }

  .comment-details h4 {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 10px;
  }

  .comment-details p {
    line-height: 1.6;
    color: #555;
  }

  .review-btn {
    margin: 20px 0;
  }

  .review-links {
    display: inline-block;
    padding: 10px 20px;
    background: #f5f5f5;
    color: #555;
    text-decoration: none;
    border-radius: 4px;
    transition: all 0.3s ease;
  }

  .review-links:hover {
    background: #eee;
    color: #ff6a00;
  }

  /* Related Products */
  .li-trending-product-tab {
    margin-bottom: 30px;
  }

  .li-trending-product-tab h2 {
    font-size: 22px;
    font-weight: 600;
    position: relative;
    padding-bottom: 10px;
    margin-bottom: 20px;
  }

  .li-trending-product-tab h2::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 60px;
    height: 3px;
    background-color: #ff6a00;
  }

  /* Single Product Card */
  .single-product-wrap {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    margin-bottom: 20px;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .single-product-wrap:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }

  .product-image {
    position: relative;
    overflow: hidden;
  }

  .product-image a {
    display: block;
    overflow: hidden;
  }

  .product-image img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .product-image:hover img {
    transform: scale(1.1);
  }

  .sticker {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 5px 10px;
    background-color: #00c853;
    color: white;
    font-size: 12px;
    border-radius: 4px;
    font-weight: 600;
    z-index: 2;
  }

  .product_desc {
    padding: 15px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .product_desc_info {
    flex-grow: 1;
  }

  .product_name {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-decoration: none;
    transition: color 0.3s;
  }

  .product_name:hover {
    color: #ff6a00;
  }

  /* Add to Cart Actions */
  .add-actions {
    margin-top: 15px;
  }

  .add-actions-link {
    display: flex;
    justify-content: space-between;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .add-cart {
    flex: 1;
  }

  .add-cart a {
    display: block;
    padding: 10px;
    background: #ff6a00;
    color: white;
    text-align: center;
    border-radius: 4px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .add-cart a:hover {
    background: #e55f00;
  }

  .links-details {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-left: 10px;
    color: #555;
    transition: all 0.3s ease;
  }

  .links-details:hover {
    background: #f9f9f9;
    color: #ff6a00;
    border-color: #ff6a00;
  }

  /* Animation effects */
  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Apply animations */
  .single-product-area {
    animation: fadeUp 0.6s ease-out;
  }

  /* Responsive adjustments */
  @media (max-width: 992px) {
    .product-details-view-content {
      padding: 0;
      margin-top: 30px;
    }

    .lg-image {
      height: 350px;
    }
    
    .img-zoom-result {
      display: none;
    }
  }

  @media (max-width: 768px) {
    .product-social-sharing ul {
      flex-wrap: wrap;
    }

    .sm-image {
      flex: 0 0 60px;
      height: 60px;
    }

    .lg-image {
      height: 300px;
    }
  }

  @media (max-width: 576px) {
    .cart-quantity {
      flex-direction: column;
      align-items: flex-start;
    }

    .add-to-cart {
      width: 100%;
      justify-content: center;
    }

    .product-info h2 {
      font-size: 24px;
    }

    .li-product-menu {
      gap: 15px;
    }

    .li-product-menu li a {
      padding: 10px 5px;
      font-size: 14px;
    }
  }
</style>
<!-- Sticky Header Area Start -->
<div class="header-bottom header-sticky d-none d-lg-block d-xl-block">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <!-- Begin Header Bottom Menu Area -->
        <div class="hb-menu">
          <nav>
            <ul>
              <li class="dropdown-holder">
                <a href="/index">Home</a>
              </li>
              <li class="megamenu-holder">
                <a href="/shop">Shop</a>
              </li>
              <li><a href="/about">About Us</a></li>
              <li><a href="/contact">Contact</a></li>
            </ul>
          </nav>
        </div>
        <!-- Header Bottom Menu Area End Here -->
      </div>
    </div>
  </div>
</div>
<!-- Sticky Header Area End -->

<!-- Product Details Area Start -->
<div class="content-wraper">
  <div class="container">
    <!-- Breadcrumb -->
    <div class="product-breadcrumb">
      <ol>
        <li><a href="/index">Home</a></li>
        <li><a href="/shop">Shop</a></li>
        <% if (product.category) { %>
          <li><a href="/category/<%= product.category._id %>"><%= product.category.name %></a></li>
        <% } %>
        <li><%= product.productName %></li>
      </ol>
    </div>

    <div class="row single-product-area">
      <div class="col-lg-5 col-md-6">
        <!-- Product Details Left -->
        <div class="product-details-left">
          <!-- Product Badges -->
          <div class="product-badge">
            <% if (product.isNew) { %>
              <span class="badge-new">New</span>
            <% } %>
            <% if (product.regularPrice > product.salePrice) { %>
              <span class="badge-sale">Sale</span>
            <% } %>
          </div>

          <div class="product-details-images slider-navigation-1">
            <% if (product.productImage && product.productImage.length > 0) { %>
              <% product.productImage.forEach((image, index) => { %>
                <div class="lg-image">
                  <div class="img-zoom-container">
                    <img
                      src="/uploads/product-images/<%= image %>"
                      alt="<%= product.productName %>"
                      class="product-main-img <%= index === 0 ? 'active' : '' %>"
                      data-index="<%= index %>"
                    />
                    <div class="img-zoom-lens"></div>
                    <div class="img-zoom-result"></div>
                  </div>
                  <div class="zoom-hint"><i class="fa fa-search-plus"></i> Hover to zoom</div>
                </div>
              <% }); %>
            <% } else { %>
              <div class="lg-image">
                <div class="img-zoom-container">
                  <img
                    src="/images/product/large-size/default.jpg"
                    alt="<%= product.productName %>"
                    class="product-main-img active"
                    data-index="0"
                  />
                  <div class="img-zoom-lens"></div>
                  <div class="img-zoom-result"></div>
                </div>
                <div class="zoom-hint"><i class="fa fa-search-plus"></i> Hover to zoom</div>
              </div>
            <% } %>
          </div>

          <div class="product-details-thumbs slider-thumbs-1">
            <% if (product.productImage && product.productImage.length > 0) { %>
              <% product.productImage.forEach((image, index) => { %>
                <div class="sm-image <%= index === 0 ? 'active' : '' %>" data-index="<%= index %>">
                  <img
                    src="/uploads/product-images/<%= image %>"
                    alt="product image thumb"
                    data-large="/uploads/product-images/<%= image %>"
                  />
                </div>
              <% }); %>
            <% } else { %>
              <div class="sm-image active" data-index="0">
                <img
                  src="/images/product/small-size/default.jpg"
                  alt="product image thumb"
                  data-large="/images/product/large-size/default.jpg"
                />
              </div>
            <% } %>
          </div>
        </div>
        <!--// Product Details Left -->
      </div>

      <div class="col-lg-7 col-md-6">
        <div class="product-details-view-content sp-normal-content pt-60">
          <div class="product-info">
            <h2><%= product.productName %></h2>
            <span class="product-details-ref">
              Reference: <%= product.productSKU || 'N/A' %>
            </span>
            
            <div class="rating-box pt-20">
              <ul class="rating rating-with-review-item">
                <% for (let i = 0; i < 5; i++) { %>
                  <% if (i < Math.round(product.rating || 0)) { %>
                    <li><i class="fa fa-star"></i></li>
                  <% } else { %>
                    <li class="no-star"><i class="fa fa-star-o"></i></li>
                  <% } %>
                <% } %>
                <li class="review-item">
                  <a href="#reviews">
                    <%= product.reviews ? product.reviews.length : 0 %> Reviews
                  </a>
                </li>
                <li class="review-item">
                  <a href="#" data-toggle="modal" data-target="#mymodal">
                    <i class="fa fa-pencil"></i> Write Review
                  </a>
                </li>
              </ul>
            </div>
            
            <div class="price-box pt-20">
              <span class="new-price new-price-2">
                â‚¹<%= product.salePrice.toFixed(2) %>
              </span>
              <% if (product.regularPrice > product.salePrice) { %>
                <span class="old-price">
                  â‚¹<%= product.regularPrice.toFixed(2) %>
                </span>
                <span class="discount-percentage">
                  -<%= ((product.regularPrice - product.salePrice) / product.regularPrice * 100).toFixed(0) %>%
                </span>
              <% } %>
            </div>
            
            <div class="product-desc">
              <p>
                <span><%= product.shortDescription %></span>
              </p>
            </div>
            
            <div class="single-add-to-cart">
              <form
                action="/cart/add/<%= product._id %>"
                method="POST"
                class="cart-quantity"
              >
                <div class="quantity">
                  <label>Quantity</label>
                  <div class="cart-plus-minus">
                    <input
                      class="cart-plus-minus-box"
                      value="1"
                      type="text"
                      name="quantity"
                    />
                    <div class="dec qtybutton">
                      <i class="fa fa-angle-down"></i>
                    </div>
                    <div class="inc qtybutton">
                      <i class="fa fa-angle-up"></i>
                    </div>
                  </div>
                </div>
                <button class="add-to-cart" type="submit">
                  <i class<button class="add-to-cart" type="submit">
                    <i class="fa fa-shopping-cart"></i> Add to Cart
                  </button>
                  </form>
                  </div>
                  
                  <!-- Product Social Sharing -->
                  <div class="product-social-sharing">
                    <h3>Share This Product</h3>
                    <ul>
                      <li class="facebook">
                        <a href="#"><i class="fa fa-facebook"></i> Facebook</a>
                      </li>
                      <li class="twitter">
                        <a href="#"><i class="fa fa-twitter"></i> Twitter</a>
                      </li>
                      <li class="google-plus">
                        <a href="#"><i class="fa fa-google-plus"></i> Google+</a>
                      </li>
                      <li class="instagram">
                        <a href="#"><i class="fa fa-instagram"></i> Instagram</a>
                      </li>
                    </ul>
                  </div>
                  </div>
                  </div>
                  </div>
                  
                  <!-- Product Description Tabs -->
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="li-product-tab">
                        <ul class="li-product-menu">
                          <li><a class="active" data-toggle="tab" href="#description">Description</a></li>
                          <li><a data-toggle="tab" href="#product-details">Product Details</a></li>
                          <li><a data-toggle="tab" href="#reviews">Reviews</a></li>
                        </ul>
                      </div>
                      <!-- Tab Content -->
                      <div class="tab-content">
                        <div id="description" class="tab-pane active show" role="tabpanel">
                          <div class="product-description">
                            <%= product.description %>
                          </div>
                        </div>
                        <div id="product-details" class="tab-pane" role="tabpanel">
                          <div class="product-details-manufacturer">
                            <% if (product.brand && product.brand.logo) { %>
                              <img src="/uploads/brand-logos/<%= product.brand.logo %>" alt="<%= product.brand.name %>">
                            <% } %>
                            <p><span>Product Code:</span> <%= product.productSKU || 'N/A' %></p>
                            <p><span>Availability:</span> <%= product.stockQuantity > 0 ? 'In Stock' : 'Out of Stock' %></p>
                            <% if (product.brand) { %>
                              <p><span>Brand:</span> <%= product.brand.name %></p>
                            <% } %>
                            <% if (product.category) { %>
                              <p><span>Category:</span> <%= product.category.name %></p>
                            <% } %>
                            <% if (product.tags && product.tags.length > 0) { %>
                              <p><span>Tags:</span> <%= product.tags.join(', ') %></p>
                            <% } %>
                          </div>
                        </div>
                        <div id="reviews" class="tab-pane" role="tabpanel">
                          <div class="product-reviews">
                            <div class="product-details-comment-block">
                              <% if (product.reviews && product.reviews.length > 0) { %>
                                <% product.reviews.forEach(review => { %>
                                  <div class="comment-details">
                                    <div class="comment-author-infos">
                                      <h4><%= review.user ? review.user.name : 'Anonymous' %></h4>
                                      <div class="comment-review">
                                        <ul class="rating">
                                          <% for (let i = 0; i < 5; i++) { %>
                                            <% if (i < review.rating) { %>
                                              <li><i class="fa fa-star"></i></li>
                                            <% } else { %>
                                              <li class="no-star"><i class="fa fa-star-o"></i></li>
                                            <% } %>
                                          <% } %>
                                        </ul>
                                        <span><%= review.createdAt.toLocaleDateString() %></span>
                                      </div>
                                    </div>
                                    <p><%= review.comment %></p>
                                  </div>
                                <% }); %>
                              <% } else { %>
                                <p>No reviews yet. Be the first to review this product!</p>
                              <% } %>
                              <div class="review-btn">
                                <a class="review-links" href="#" data-toggle="modal" data-target="#mymodal">Write Your Review!</a>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Related Products -->
                  <div class="li-trending-product pt-60 pb-45">
                    <div class="container">
                      <div class="row">
                        <div class="col-lg-12">
                          <div class="li-trending-product-tab">
                            <h2>Related Products</h2>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-lg-12">
                          <div class="row">
                            <% if (relatedProducts && relatedProducts.length > 0) { %>
                              <% relatedProducts.forEach(relatedProduct => { %>
                                <div class="col-lg-3 col-md-4 col-sm-6">
                                  <div class="single-product-wrap">
                                    <div class="product-image">
                                      <a href="/product/<%= relatedProduct._id %>">
                                        <img src="/uploads/product-images/<%= relatedProduct.productImage[0] || 'default.jpg' %>" alt="<%= relatedProduct.productName %>">
                                      </a>
                                      <% if (relatedProduct.isNew) { %>
                                        <span class="sticker">New</span>
                                      <% } %>
                                    </div>
                                    <div class="product_desc">
                                      <div class="product_desc_info">
                                        <h4>
                                          <a class="product_name" href="/product/<%= relatedProduct._id %>">
                                            <%= relatedProduct.productName %>
                                          </a>
                                        </h4>
                                        <div class="price-box">
                                          <span class="new-price">â‚¹<%= relatedProduct.salePrice.toFixed(2) %></span>
                                          <% if (relatedProduct.regularPrice > relatedProduct.salePrice) { %>
                                            <span class="old-price">â‚¹<%= relatedProduct.regularPrice.toFixed(2) %></span>
                                          <% } %>
                                        </div>
                                      </div>
                                      <div class="add-actions">
                                        <ul class="add-actions-link">
                                          <li class="add-cart">
                                            <a href="/cart/add/<%= relatedProduct._id %>?quantity=1">Add to cart</a>
                                          </li>
                                          <li>
                                            <a href="#" title="quick view" class="links-details">
                                              <i class="fa fa-eye"></i>
                                            </a>
                                          </li>
                                        </ul>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              <% }); %>
                            <% } else { %>
                              <div class="col-12">
                                <p>No related products found.</p>
                              </div>
                            <% } %>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Related Products End -->
                  
                  </div>
                  </div>
                  <!-- Product Details Area End -->
                  
                  <!-- Review Modal -->
                  <div class="modal fade" id="mymodal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="modalLabel">Write Your Review</h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <form action="/product/<%= product._id %>/review" method="POST">
                            <div class="form-group">
                              <label for="review-title">Title</label>
                              <input type="text" class="form-control" id="review-title" name="title" required>
                            </div>
                            <div class="form-group">
                              <label>Rating</label>
                              <div class="rating-selection">
                                <% for (let i = 5; i >= 1; i--) { %>
                                  <input type="radio" id="star<%= i %>" name="rating" value="<%= i %>" <%= i === 5 ? 'checked' : '' %>>
                                  <label for="star<%= i %>"><i class="fa fa-star"></i></label>
                                <% } %>
                              </div>
                            </div>
                            <div class="form-group">
                              <label for="review-comment">Your Review</label>
                              <textarea class="form-control" id="review-comment" name="comment" rows="5" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Submit Review</button>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Script Section -->
                  <script>
                    // Image Zoom Effect
                    document.addEventListener('DOMContentLoaded', function() {
                      // Image switcher for thumbnails
                      const thumbnails = document.querySelectorAll('.sm-image');
                      const mainImages = document.querySelectorAll('.product-main-img');
                      
                      thumbnails.forEach(thumb => {
                        thumb.addEventListener('click', function() {
                          // Remove active class from all thumbnails
                          thumbnails.forEach(t => t.classList.remove('active'));
                          // Add active class to clicked thumbnail
                          this.classList.add('active');
                          
                          // Get index of clicked thumbnail
                          const index = this.getAttribute('data-index');
                          
                          // Hide all main images
                          mainImages.forEach(img => {
                            img.closest('.lg-image').style.display = 'none';
                          });
                          
                          // Show corresponding main image
                          const targetImage = document.querySelector(`.product-main-img[data-index="${index}"]`);
                          if (targetImage) {
                            targetImage.closest('.lg-image').style.display = 'flex';
                          }
                        });
                      });
                      
                      // Quantity buttons
                      const qtyButtons = document.querySelectorAll('.qtybutton');
                      qtyButtons.forEach(button => {
                        button.addEventListener('click', function() {
                          const inputField = this.parentElement.querySelector('.cart-plus-minus-box');
                          let currentValue = parseInt(inputField.value);
                          
                          if (this.classList.contains('inc')) {
                            currentValue += 1;
                          } else if (currentValue > 1) {
                            currentValue -= 1;
                          }
                          
                          inputField.value = currentValue;
                        });
                      });
                      
                      // Image zoom effect
                      const mainImgContainers = document.querySelectorAll('.img-zoom-container');
                      
                      mainImgContainers.forEach(container => {
                        const img = container.querySelector('img');
                        const lens = container.querySelector('.img-zoom-lens');
                        const result = container.querySelector('.img-zoom-result');
                        
                        container.addEventListener('mousemove', function(e) {
                          if (window.innerWidth <= 992) return; // Disable on small screens
                          
                          const rect = container.getBoundingClientRect();
                          
                          // Calculate position of lens
                          let x = e.clientX - rect.left;
                          let y = e.clientY - rect.top;
                          
                          // Prevent lens from going outside the image
                          if (x > container.offsetWidth) {x = container.offsetWidth;}
                          if (x < 0) {x = 0;}
                          if (y > container.offsetHeight) {y = container.offsetHeight;}
                          if (y < 0) {y = 0;}
                          
                          // Set lens position
                          lens.style.left = (x - lens.offsetWidth / 2) + "px";
                          lens.style.top = (y - lens.offsetHeight / 2) + "px";
                          
                          // Calculate ratio
                          let cx = result.offsetWidth / lens.offsetWidth;
                          let cy = result.offsetHeight / lens.offsetHeight;
                          
                          // Set background of result
                          result.style.backgroundImage = "url('" + img.src + "')";
                          result.style.backgroundSize = (img.width * cx) + "px " + (img.height * cy) + "px";
                          result.style.backgroundPosition = "-" + (x * cx) + "px -" + (y * cy) + "px";
                        });
                      });
                      
                      // Tab navigation
                      const tabLinks = document.querySelectorAll('.li-product-menu a');
                      const tabContents = document.querySelectorAll('.tab-pane');
                      
                      tabLinks.forEach(link => {
                        link.addEventListener('click', function(e) {
                          e.preventDefault();
                          
                          // Remove active class from all links
                          tabLinks.forEach(tl => tl.classList.remove('active'));
                          // Add active class to clicked link
                          this.classList.add('active');
                          
                          // Hide all tab contents
                          tabContents.forEach(tc => tc.classList.remove('active', 'show'));
                          
                          // Show corresponding tab content
                          const tabId = this.getAttribute('href').substring(1);
                          const tabContent = document.getElementById(tabId);
                          if (tabContent) {
                            tabContent.classList.add('active', 'show');
                          }
                        });
                      });
                    });
                  </script>
                  
                  <%- include('../partials/footer.ejs') %>